<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

    <nav class="navbar">
        <h:link outcome="index">
            <div class="logo"></div>
        </h:link>

        <div id="hamburger-icon">
            <div class="bar1"></div>
            <div class="bar2"></div>
            <div class="bar3"></div>
        </div>
        
        <div class="right">
            <h:form id="searchForm" class="search-icon-container">

                <h:selectOneMenu styleClass="search-dropdown" id="searchOption" value="#{searchBackingBean.searchOption}">
                    <f:selectItems value="#{searchBackingBean.searchOptionValue}" />
                </h:selectOneMenu>

                <h:inputText class="search-input" value="#{searchBackingBean.searchTerm}" />

                <h:commandLink action="#{searchBackingBean.search}">
                    <h:graphicImage id="t1" class="navbar-icon" library="images" name="search.png" alt="Search Icon" />
                </h:commandLink>

            </h:form>

            <h:link outcome="shopping_cart">
                <h:graphicImage class="navbar-icon" library="images" name="shopping-cart.png" alt="Shoppping Cart Icon" />
            </h:link>

            <ui:fragment rendered="#{!navbarBackingBean.userLoggedIn}">
                <h:link class="navbar-link" value="#{msgs.loginbutton}" outcome="login" />
            </ui:fragment>
            
            <ui:fragment rendered="#{navbarBackingBean.userLoggedIn}">
                <a id="navbarUsername" class="navbar-link">#{navbarBackingBean.username}</a>
            </ui:fragment>

            <script>
                
                var $searchInput = $(".search-input").first();
                var $searchDropdown = $(".search-dropdown").first();
                
                $("#searchForm\\:t1").mouseenter(function()
                {
                    $searchInput.stop();
                    $searchInput.show();
                    $searchInput.animate({width: "200px"}, 900, function()
                    {
                        $searchDropdown.stop();
                        $searchDropdown.show();
                        $searchDropdown.animate({opacity: 1}, 900);
                    });
                });

                $searchInput.focusout(function()
                {
                    $searchDropdown.stop();
                    $searchDropdown.animate({opacity: 0}, 900, function()
                    {
                        $searchDropdown.hide();
                    });
                    
                    $searchInput.stop();
                    $searchInput.animate({width: "0px"}, 900, function()
                    {
                        $searchInput.hide();
                    });
                });
            </script>
        </div>
    </nav>
    
    <div id="navbar-menu">
        <a href="#news">Login</a>
        <a href="#contact">Shopping Cart</a>
        <a href="#about">About</a>
    </div>
    
    <ui:fragment rendered="#{navbarBackingBean.userLoggedIn}">
        <div class="navbar-user-menu">
            <h:form>
                <h:commandLink value="Downloads" action="@null" />

                <ui:fragment rendered="#{navbarBackingBean.manager}">
                    <h:commandLink value="Manager" action="management_home" />
                </ui:fragment>

                <h:commandLink value="Logout" action="#{navbarBackingBean.logout()}" />
            </h:form>
        </div>
    </ui:fragment>
    
</ui:composition>